# ==========================================
# 기본 DB 설정 (로컬: H2 메모리, MySQL 문법 호환)
# ==========================================
spring:
  datasource:
    # 기본값: H2 메모리 DB (MySQL 문법 호환을 위해 MODE=MySQL 옵션 추가)
    url: ${DB_URL:jdbc:h2:mem:testdb;MODE=MySQL}
    driver-class-name: ${DB_DRIVER:org.h2.Driver}
    username: ${DB_USERNAME:sa}
    password: ${DB_PASSWORD:}

  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
        enable_lazy_load_no_trans: true

  h2:
    console:
      enabled: true # http://localhost:8080/h2-console

  jackson:
    serialization:
      FAIL_ON_EMPTY_BEANS: false

# ==========================================
# JWT 설정 (로컬 개발 기본값)
# ==========================================
jwt:
  secret: ${JWT_SECRET:ThisIsAVeryLongLocalDevSecretKey_AtLeast32Chars!}
  access-token-validity-ms: 900000          # 15분
  refresh-token-validity-ms: 1209600000     # 14일

# ==========================================
# 메일 / Redis / App 기본 설정
# ==========================================
mail:
  username: ${MAIL_USERNAME:}
  password: ${MAIL_PASSWORD:}

redis:
  host: ${REDIS_HOST:localhost}
  port: ${REDIS_PORT:6379}

app:
  verify:
    base-url: ${APP_VERIFY_BASE_URL:http://localhost:8080}

# ==========================================
# Swagger / OpenAPI 설정
# ==========================================
springdoc:
  api-docs:
    enabled: true
  swagger-ui:
    enabled: true
  packages-to-scan: com.ll.P_A
  paths-to-match: /**
  remove-broken-reference-definitions: true
  default-consumes-media-type: application/json
  default-produces-media-type: application/json

# ==========================================
# 결제 관련 (공통 설정)
# ==========================================
trade:
  mode: ${TRADE_MODE:MOCK}           # MOCK | PG
  pg:
    provider: ${TRADE_PG_PROVIDER:TOSS}
    apiKey: ${TRADE_PG_API_KEY:}
    secretKey: ${TRADE_PG_SECRET:}
    webhookSecret: ${TRADE_PG_WEBHOOK_SECRET:}
    endpointBaseUrl: ${TRADE_PG_ENDPOINT_BASE_URL:https://sandbox-pay.example.com}
  webhook:
    endpointPath: /api/trade/payments/webhook
  idempotency:
    ttlSeconds: ${TRADE_IDEMPOTENCY_TTL_SECONDS:86400}

# ==========================================
#  Toss Payments 테스트 환경 추가
# ==========================================
toss:
  # TossPayments 테스트 모드: 실제 결제 없음
  # (개발자 센터 → 테스트 프로젝트 → Key 확인)
  client-key: ${TOSS_CLIENT_KEY:test_gck_docs_Ovk5rk1EwkEbP0W43n07xlzm}
  secret-key: ${TOSS_SECRET_KEY:test_sk_exampleSecretKeyReplaceMe}
  customer-key: ${TOSS_CUSTOMER_KEY:SBxrz80rBtb6ZRTvVpZC-}

  # 테스트 API 엔드포인트
  endpoint:
    confirm: https://api.tosspayments.com/v1/payments/confirm
    widget: https://js.tosspayments.com/v1/payment-widget

  # Toss 개발자 센터 문서 경로 (참고용)
  docs:
    guide-url: https://docs.tosspayments.com/guides/payment-widget/integration

# ==========================================
# 서버 정보 (로컬 / 개발 환경 구분용)
# ==========================================
server:
  port: ${PORT:8080}
  error:
    include-message: always
    include-binding-errors: always

logging:
  level:
    root: INFO
    org.springframework.web: INFO
    com.ll.P_A: DEBUG